SELECT -- SGH10
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH10'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'TAPE&Film TTL' AS site, -- SGH10 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH10') AS subquery
 
UNION ALL

SELECT -- SGH20
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH20'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'Optical Film' AS site, -- SGH20 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH20') AS subquery

UNION ALL

SELECT -- SGH30
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH30'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'Foldable Film' AS site, -- SGH30 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH30') AS subquery

UNION ALL

SELECT -- SGH40
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH40'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'DECO Film' AS site, -- SGH40 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH40') AS subquery

UNION ALL

SELECT -- SGH50
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH50'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'PCPMMA Film' AS site, -- SGH50 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH50') AS subquery

UNION ALL

SELECT -- SGH60
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CAST(planqty01 AS decimal) AS planqty01,
        CAST( Amount01 AS decimal) AS Amount01,
        CAST(planqty02 AS decimal) AS planqty02,
        CAST( Amount02 AS decimal) AS Amount02,
        CAST(planqty03 AS decimal) AS planqty03,
        CAST( Amount03 AS decimal) AS Amount03,
        CAST(planqty04 AS decimal) AS planqty04,
        CAST( Amount04 AS decimal) AS Amount04,
        CAST(planqty05 AS decimal) AS planqty05,
        CAST( Amount05 AS decimal) AS Amount05,
        CAST(planqty06 AS decimal) AS planqty06,
        CAST( Amount06 AS decimal) AS Amount06,
        CAST(planqty07 AS decimal) AS planqty07,
        CAST( Amount07 AS decimal) AS Amount07,
        CAST(planqty08 AS decimal) AS planqty08,
        CAST( Amount08 AS decimal) AS Amount08,
        CAST(planqty09 AS decimal) AS planqty09,
        CAST( Amount09 AS decimal) AS Amount09,
        CAST(planqty10 AS decimal) AS planqty10,
        CAST( Amount10 AS decimal) AS Amount10,
        CAST(planqty11 AS decimal) AS planqty11,
        CAST( Amount11 AS decimal) AS Amount11,
        CAST(planqty12 AS decimal) AS planqty12,
        CAST( Amount12 AS decimal) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH60'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'Scolor Film' AS site, -- SGH60 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH60') AS subquery

UNION ALL

SELECT '세경 KOR Etc' AS site, -- SGH70 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGH70') AS subquery

UNION ALL

SELECT '세경 KOR TTL' AS site, -- SGH total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 like 'SGH%') AS subquery

UNION ALL

SELECT -- SGV10
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV10'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'TAPE&Film TTL' AS site, -- SGV10 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV10') AS subquery
 
UNION ALL

SELECT -- SGV20
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV20'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'Optical Film' AS site, -- SGV20 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV20') AS subquery

UNION ALL

SELECT -- SGV30
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV30'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'Foldable Film' AS site, -- SGV30 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV30') AS subquery

UNION ALL

SELECT -- SGV40
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV40'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'DECO Film' AS site, -- SGV40 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV40') AS subquery

UNION ALL

SELECT -- SGV50
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV50'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'PCPMMA Film' AS site, -- SGV50 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV50') AS subquery

UNION ALL

SELECT -- SGV60
    site,
    subquery.TYPE AS TYPE,
    customer,
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CAST(planqty01 AS decimal) AS planqty01,
        CAST( Amount01 AS decimal) AS Amount01,
        CAST(planqty02 AS decimal) AS planqty02,
        CAST( Amount02 AS decimal) AS Amount02,
        CAST(planqty03 AS decimal) AS planqty03,
        CAST( Amount03 AS decimal) AS Amount03,
        CAST(planqty04 AS decimal) AS planqty04,
        CAST( Amount04 AS decimal) AS Amount04,
        CAST(planqty05 AS decimal) AS planqty05,
        CAST( Amount05 AS decimal) AS Amount05,
        CAST(planqty06 AS decimal) AS planqty06,
        CAST( Amount06 AS decimal) AS Amount06,
        CAST(planqty07 AS decimal) AS planqty07,
        CAST( Amount07 AS decimal) AS Amount07,
        CAST(planqty08 AS decimal) AS planqty08,
        CAST( Amount08 AS decimal) AS Amount08,
        CAST(planqty09 AS decimal) AS planqty09,
        CAST( Amount09 AS decimal) AS Amount09,
        CAST(planqty10 AS decimal) AS planqty10,
        CAST( Amount10 AS decimal) AS Amount10,
        CAST(planqty11 AS decimal) AS planqty11,
        CAST( Amount11 AS decimal) AS Amount11,
        CAST(planqty12 AS decimal) AS planqty12,
        CAST( Amount12 AS decimal) AS Amount12
    FROM SG_SALES_PLAN SSP 
    JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV60'
) AS subquery
GROUP BY site, subquery.TYPE, customer

UNION ALL

SELECT 'FOD TTL' AS site, -- SGV60 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV60') AS subquery

UNION ALL

SELECT '세경 VINA Etc' AS site, -- SGV70 total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV70') AS subquery

UNION ALL

SELECT '세경 VINA TTL' AS site, -- SGV total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 like 'SGV%') AS subquery

UNION ALL

SELECT 'Grand Total' AS site, -- Grand total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 like 'SG%') AS subquery

UNION ALL

SELECT 'Tape&Film' AS site, -- Tape&Film total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 ='SGH10' OR type1 = 'SGV10') AS subquery
    
UNION ALL

SELECT 'Foldable' AS site, -- Foldable total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 ='SGH30' OR type1 = 'SGV20') AS subquery

UNION ALL

SELECT 'Optical' AS site, -- Optical total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 ='SGH20' OR type1 = 'SGV30') AS subquery

UNION ALL

SELECT 'Deco Film' AS site, -- Deco Film total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 ='SGH40' OR type1 = 'SGV40') AS subquery

UNION ALL

SELECT 'PCPMMA' AS site, -- PCPMMA total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 ='SGH50' OR type1 = 'SGV50') AS subquery

UNION ALL

SELECT 'FOD' AS site, -- FOD total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 = 'SGV60') AS subquery

UNION all    
    
SELECT 'Scolor' AS site, -- Scolor total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 ='SGH60') AS subquery

UNION ALL

SELECT 'Etc' AS site, -- Etc total
	NULL AS TYPE,
	NULL AS customer, 
    SUM(planqty01) AS planqty01,
    SUM( Amount01) AS Amount01,
    SUM(planqty02) AS planqty02,
    SUM( Amount02) AS Amount02,
    SUM(planqty03) AS planqty03,
    SUM( Amount03) AS Amount03,
    SUM(planqty04) AS planqty04,
    SUM( Amount04) AS Amount04,
    SUM(planqty05) AS planqty05,
    SUM( Amount05) AS Amount05,
    SUM(planqty06) AS planqty06,
    SUM( Amount06) AS Amount06,
    SUM(planqty07) AS planqty07,
    SUM( Amount07) AS Amount07,
    SUM(planqty08) AS planqty08,
    SUM( Amount08) AS Amount08,
    SUM(planqty09) AS planqty09,
    SUM( Amount09) AS Amount09,
    SUM(planqty10) AS planqty10,
    SUM( Amount10) AS Amount10,
    SUM(planqty11) AS planqty11,
    SUM( Amount11) AS Amount11,
    SUM(planqty12) AS planqty12,
    SUM( Amount12) AS Amount12,
    SUM(planqty01 + planqty02 + planqty03) AS Q1,
    SUM( Amount01 +  Amount02 +  Amount03) AS Q_Amount1,
    SUM(planqty04 + planqty05 + planqty06) AS Q2,
    SUM( Amount04 +  Amount05 +  Amount06) AS Q_Amount2,
    SUM(planqty07 + planqty08 + planqty09) AS Q3,
    SUM( Amount07 +  Amount08 +  Amount09) AS Q_Amount3,
    SUM(planqty10 + planqty11 + planqty12) AS Q4,
    SUM( Amount10 +  Amount11 +  Amount12) AS Q_Amount4,
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06) AS '1st_Half',
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06) AS '1st_Amount',
    SUM(planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS '2nd_Half',
    SUM( Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS '2nd_Amount',
    SUM(planqty01 + planqty02 + planqty03 + planqty04 + planqty05 + planqty06 + planqty07 + planqty08 + planqty09 + planqty10 + planqty11 + planqty12) AS YEAR,
    SUM( Amount01 +  Amount02 +  Amount03 +  Amount04 +  Amount05 +  Amount06 +  Amount07 +  Amount08 +  Amount09 +  Amount10 +  Amount11 +  Amount12) AS YEAR_Amount
     FROM (
    SELECT site,BM.MINOR_NM AS TYPE,customer,
        CONVERT(decimal, ISNULL(planqty01,0)) AS planqty01,
		CONVERT(decimal, ISNULL(Amount01, 0)) AS Amount01,
		CONVERT(decimal, ISNULL(planqty02,0)) AS planqty02,
		CONVERT(decimal, ISNULL(Amount02, 0)) AS Amount02,
		CONVERT(decimal, ISNULL(planqty03,0)) AS planqty03,
		CONVERT(decimal, ISNULL(Amount03, 0)) AS Amount03,
		CONVERT(decimal, ISNULL(planqty04,0)) AS planqty04,
		CONVERT(decimal, ISNULL(Amount04, 0)) AS Amount04,
		CONVERT(decimal, ISNULL(planqty05,0)) AS planqty05,
		CONVERT(decimal, ISNULL(Amount05, 0)) AS Amount05,
		CONVERT(decimal, ISNULL(planqty06,0)) AS planqty06,
		CONVERT(decimal, ISNULL(Amount06, 0)) AS Amount06,
		CONVERT(decimal, ISNULL(planqty07,0)) AS planqty07,
		CONVERT(decimal, ISNULL(Amount07, 0)) AS Amount07,
		CONVERT(decimal, ISNULL(planqty08,0)) AS planqty08,
		CONVERT(decimal, ISNULL(Amount08, 0)) AS Amount08,
		CONVERT(decimal, ISNULL(planqty09,0)) AS planqty09,
		CONVERT(decimal, ISNULL(Amount09, 0)) AS Amount09,
		CONVERT(decimal, ISNULL(planqty10,0)) AS planqty10,
		CONVERT(decimal, ISNULL(Amount10, 0)) AS Amount10,
		CONVERT(decimal, ISNULL(planqty11,0)) AS planqty11,
		CONVERT(decimal, ISNULL(Amount11, 0)) AS Amount11,
		CONVERT(decimal, ISNULL(planqty12,0)) AS planqty12,
		CONVERT(decimal, ISNULL(Amount12, 0)) AS Amount12
    FROM SG_SALES_PLAN SSP JOIN B_MINOR BM ON SSP.type1 = BM.MINOR_CD 
    WHERE type1 ='SGH70' OR type1 = 'SGV70') AS subquery
